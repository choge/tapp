{% extends "base.html" %}

{% block header %}
<div id="title" class="navbar-fixed">
  <nav>
    <div class="nav-wrapper teal darken-4 white-text">
      <a href="#" class="brand-logo">Prediction result</a>
      <ul class="right hide-on-med-and-down">
        <li><a href="#title">Page top</a></li>
        <li><a href="#result_summary_title">Summary table</a></li>
        <li><a href="#result_list_title">Detail list</a></li>
        <li><a href="/">Home</a></li>
      </ul>
    </div>
  </nav>
</div>
{% end %}

{% block main %}

<div style="display: none;" id="query_id">{{ query_id }}</div>

<div class="container" id="status">
  <div class="row">
    <div class="col s2 teal lighten-5">STATUS</div>
    <div class="col s4 teal lighten-4" id="status-text">CALCULATING...</div>
    <div class="col s6" id="status-progress">
      <div class="progress">
        <div class="indeterminate"></div>
      </div>
    </div>
  </div>
  <div class="row valign-wrapper" id="email-address">
    <form action='/mail/{{ query_id }}' method='post'>
      <div class="input-field col s10 valign">
        <i class="mdi-content-mail small prefix" id="input-icon-mail"></i>
        <input id="email" type="email" class="validate" name="email">
        <label for="input-icon-mail">Email</label>
      </div>
      <div class="col s2 valign">
        <button class="btn waves-effect waves-light" type="submit" name="action" action="/mailsend">Submit
          <i class="mdi-content-send"></i>
        </button>
      </div>
    </form>
  </div>
  <div class="col s12" id="notification">
    It may take some time to finish calculation in case you have requested
    many or long sequences. (Approximately 10 secs / 100 seqs) <br />
    You can input your email-address above and you will be informed
    when the calculation has finished.
  </div>
</div>


<h4 id="result_summary_title">Your results:</h4>
<table class="striped row" id="result_summary">
  <thead>
    <tr>
      <th class="col s6" data-field="id">ID 
        <a class="waves-effect waves-light modal-trigger" href="#help_identifier">
          <i class="mdi-action-help teal-text text-lighten-3"></i></a></th>
      <th class="col s2" data-field="prediction_result">Result 
        <a class="waves-effect waves-light modal-trigger" href="#help_result">
          <i class="mdi-action-help teal-text text-lighten-3"></i></a></th>
      <th class="col s2" data-field="score">Score 
        <a class="waves-effect waves-light modal-trigger" href="#help_score">
          <i class="mdi-action-help teal-text text-lighten-3"></i></a></th>
      <th class="col s2" data-field="TMD">TMD 
        <a class="waves-effect waves-light modal-trigger" href="#help_tmd">
          <i class="mdi-action-help teal-text text-lighten-3"></i></a></th>
    </tr>
  </thead>
  <tbody>
    {% for query in query_data %}
    <tr id="summary_{{ query.identifier }}">
      <td class="id truncate col s6">
        <a href="#detail_{{ query.identifier }}">
          {{ query.identifier }}
        </a>
        </td>
      <td class="result col s2">Loading...</td>
      <td class="score col s2">Loading...</td>
      <td class="tmd col s2">Loading...</td>
    </tr>
    {% end %}
  </tbody>
</table>

<h4 id="result_list_title">Detailed results:</h4>
<ul id="result_list" class="collection">
  {% for query in query_data %}
    <li id="detail_{{ query.identifier }}" class="collection-item">
      <div class="query_id">{{ query.identifier }}</div>
      <div class="query_detail" style="margin-left: 20px">
        Loading...
      </div>
      <div class="hide sequence">{{ query.sequence }}</div>
    </li>
  {% end %}
</ul>


<!-- help contents (loaded by modal-trigger) -->
<div id="help_identifier" class="modal modal-fixed-footer">
  <div class="modal-content">
    <h4>About identifier</h4>
    <p>Each identifier is taken from the header line of your query.</p>
  </div>
  <div class="modal-footer">
    <a href="#!" class=" modal-action modal-close waves-effect waves-green btn-flat">Close</a>
  </div>
</div>

<div id="help_result" class="modal modal-fixed-footer">
  <div class="modal-content">
    <h4>About result</h4>
    <p>A sequence is considered by a TA protein when score is greater than the threshold
    </p>
  </div>
  <div class="modal-footer">
    <a href="#!" class=" modal-action modal-close waves-effect waves-green btn-flat">Close</a>
  </div>
</div>

<div id="help_score" class="modal modal-fixed-footer">
  <div class="modal-content">
    <h4>About result</h4>
    <p>A sequence is considered by a TA protein when score is greater than the threshold
    </p>
  </div>
  <div class="modal-footer">
    <a href="#!" class=" modal-action modal-close waves-effect waves-green btn-flat">Close</a>
  </div>
</div>

<div id="help_tmd" class="modal modal-fixed-footer">
  <div class="modal-content">
    <h4>About result</h4>
    <p>A sequence is considered by a TA protein when score is greater than the threshold
    </p>
  </div>
  <div class="modal-footer">
    <a href="#!" class=" modal-action modal-close waves-effect waves-green btn-flat">Close</a>
  </div>
</div>
{% end %}

{% block custom_js %}
<script type="text/javascript" src="{{ static_url('result.js') }}"></script>
{% end %}
